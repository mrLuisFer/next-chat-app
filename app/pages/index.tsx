import type { NextPage } from "next";
import Head from "next/head";
import { Box, List, ListItem, Text, useBoolean, Fade, Link as ChakraLink } from "@chakra-ui/react";
import Link from "../components/Link";
import { IoChatbubbleEllipses } from "react-icons/io5";
import GitHubProjects from "../components/GitHubProjects";
import { Octokit } from "octokit";
import { HiHashtag } from "react-icons/hi";
import ContactHomeSection from "../components/ContactHomeSection";

const Item = ({ children }: { children: any }) => {
  return (
    <ListItem transition="0.15s ease-in-out" userSelect="none" _hover={{ color: "blackAlpha.700" }}>
      {children}
    </ListItem>
  );
};

const Header = () => {
  return (
    <Box
      as="header"
      display="flex"
      alignItems="center"
      justifyContent="space-between"
      p="1rem 2rem"
      boxShadow="0 3px 3px rgba(0, 0, 0, 0.05)"
      color="blackAlpha.600"
      fontSize="1rem"
    >
      <Link
        to="/"
        color="gray.900"
        display="flex"
        alignItems="center"
        fontWeight="bold"
        gridGap="0.3em"
        cursor="pointer"
        p="0.3rem 0.8rem"
        _hover={{
          bg: "gray.100",
          borderRadius: "8px",
        }}
      >
        <IoChatbubbleEllipses />
        <Text as="span">Chat</Text>
      </Link>
      <List display="flex" alignItems="center" gridGap="1.4rem">
        <Item>
          <ChakraLink href="#projects" _hover={{ textDecoration: "none" }}>
            Projects
          </ChakraLink>
        </Item>
        <Item>
          <ChakraLink href="#contactus" _hover={{ textDecoration: "none" }}>
            Contact Us
          </ChakraLink>
        </Item>
      </List>
      <Box display="flex" alignItems="center" justifyContent="flex-end" gridGap="1.5rem">
        <Link to="/auth/login" cursor="pointer" transition="0.15s ease-in-out" _hover={{ color: "blackAlpha.700" }}>
          Log in
        </Link>
        <Link
          to="/auth/signup"
          p="0.5rem 1rem"
          bg="black"
          borderRadius="8px"
          color="white"
          cursor="pointer"
          transition="0.15s ease-in-out"
          _hover={{
            filter: "brightness(1.15)",
            bg: "blue.500"
          }}
        >
          Sign up
        </Link>
      </Box>
    </Box>
  );
};

export const HomeTittle = ({ children }: { children: any }) => {
  const [flag, setFlag] = useBoolean();

  return (
    <Box
      color="gray.800"
      fontWeight="semibold"
      fontSize="1.5rem"
      display="flex"
      alignItems="center"
      onMouseEnter={setFlag.on}
      onMouseLeave={setFlag.off}
      opacity="0.8"
      w="fit-content"
      cursor="default"
      transition="0.15s ease"
      _hover={{
        opacity: "1",
      }}
    >
      <Fade in={flag}>
        <HiHashtag />
      </Fade>
      {children}
    </Box>
  );
};

export const getServerSideProps = async () => {
  const octokit = new Octokit({ auth: process.env.GITHUB_OCTOKIT_AUTH });
  const res = await octokit.request("GET /user/repos");

  if (res) {
    return { props: { ghUserData: res.data } };
  }
};

const Home: NextPage<{ ghUserData: any[] }> = ({ ghUserData = [] }) => {
  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Box as="main">
        <Header />
        <Box as="section" p="1rem 3rem">
          <HomeTittle>Projects</HomeTittle>
          <GitHubProjects ghUserData={ghUserData} />
          <Box display="block" w="100%" mt="2rem" />
          <HomeTittle>Contact</HomeTittle>
          <ContactHomeSection />
        </Box>
        <Box p="0 3rem">
          <Box as="footer" color="blackAlpha.500" borderTop="1px solid" borderColor="gray.300" p="1rem 0 2rem">
            <Text userSelect="none">2022 Chat. All rights reserved.</Text>
          </Box>
        </Box>
      </Box>
    </>
  );
};

export default Home;
